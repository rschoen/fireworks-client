
<dom-module id="fireworks-card">

  <style>
  :host {
  perspective: 1000px;
  display: inline-block;
  }


  
  .card, .back, .front {
	width: 47px;
	height: 60px;
	border-radius: 2px;
	cursor: pointer;
  }
  
  .back, .front {
	backface-visibility: hidden;
	position: absolute;
	top: 0;
	left: 0;
	text-shadow: 1px 1px #444;
  }
  
  div.card {
	border: 1px solid #AAA;
	position: relative;
/*	transform-style: preserve-3d;
	transition: 0.4s;
	transform: rotateY(180deg);*/
  }
  
/*  div.faceup {
  	transform: none;
	transform-style: preserve-3d;
	transition: 0.4s;
  }
*/
  
  
  div.back {
	background-color: #AAA;
	background-image: url("/images/hanabi.jpg");
	background-size: 47px 78px;
/*	transform: rotateY(180deg); */
	border: 2px solid white;
	box-sizing: border-box;
	color: white;
	font-size: 25pt;
	text-align: center;
	z-index: 5;
  }
  
 .faceup div.back {
	display: none;
 }
  
  div.contentarea {
	border: 2px solid #006;
	width: 100%;
	height: 100%;
	border-radius: 2px;
	box-sizing: border-box;
	background-color: #005C99;
  }
  
  div.front {
	z-index: 4;
  }
  
/* 
  div.number:first-of-type {
	text-align: left;
	vertical-align: top;
	left: 4px;
	top: 1px;
  }
*/
  div.number {
	font-size: 3.8em;
	font-family: Arial;
//	text-align: right;
//	vertical-align: bottom;
	position: absolute;
	left: 6px; //130px;
	top: -5px; //225px;
	font-weight: bold;
  }

  
  .color-blue, #known.knowncolor-blue {
	color: #09F;
  }
  .color-red, #known.knowncolor-red {
	color: #F33;
  }
  .color-green, #known.knowncolor-green {
	color: #090;
  }
  .color-yellow, #known.knowncolor-yellow {
	color: #FD4;
  }
  .color-white, #known.knowncolor-white {
	color: white;
  }
  
  .firework {
	position: absolute;
	display: none;
  }
  /*
  .color-blue .firework {
	filter: hue-rotate(230deg) brightness(2.5);
	-webkit-filter: hue-rotate(230deg) brightness(2.5);
  }
  .color-red .firework {
	filter: brightness(6);
	-webkit-filter: brightness(6);
  }
  .color-green .firework {
	filter: hue-rotate(140deg) brightness(1.5);
	-webkit-filter: hue-rotate(140deg) brightness(1.5);
  
  }
  .color-yellow .firework {
	filter: hue-rotate(70deg) saturate(50);
	-webkit-filter: hue-rotate(70deg) saturate(50);
  
  }
  .color-white .firework {
	filter: grayscale(100%) brightness(7);
	-webkit-filter: grayscale(100%) brightness(7);
  
  }
  
  
  .number-1 .firework1 {
	left: 70px;
	top: 130px;
  
  }
  .number-1 .firework2 {
	display: none;
  }
  .number-1 .firework3 {
	display: none;
  }
  .number-1 .firework4 {
	display: none;
  }
  .number-1 .firework5 {
	display: none;
  }
  .number-2 .firework1, .number-4 .firework1 {
	left: 90px;
	top: 100px;
  }
  .number-2 .firework2, .number-4 .firework2 {
	left: 50px;
	top: 150px;
  }
  .number-2 .firework3 {
	display: none;
  }
  .number-2 .firework4 {
	display: none;
  }
  .number-2 .firework5 {
	display: none;
  }
  .number-3 .firework1, .number-5 .firework1 {
	left: 40px;
	top: 100px;
  }
  .number-3 .firework2, .number-5 .firework2 {
	left: 110px;
	top: 130px;
  }
  .number-3 .firework3, .number-5 .firework3 {
	left: 30px;
	top: 165px;
  }
  .number-3 .firework4 {
	display: none;
  }
  .number-3 .firework5 {
	display: none;
  }

  .number-4 .firework3 {
	left: 30px;
	top: 90px;
  }
  .number-4 .firework4 {
	left: 110px;
	top: 170px;
  }
  .number-4 .firework5 {
	display: none;
  }
  
  .number-5 .firework4 {
	left: 80px;
	top: 190px;
  }
  .number-5 .firework5 {
	left: 100px;
	top: 65px;
  }*/
  
  #known {
  	color: #999;
  	position: absolute;
	top: 45px;
  	left: 2px;
  	border: 1px solid white;
  	background-color: black;
  	font-family: arial;
  	font-size: 0.7em;
  	width: 12px;
  	height: 12px;
  	z-index: 6;
  	text-align: center;
  	font-weight: bold;
  }

  div.placeholder {
	border: 1px dotted #999;
	border-radius: 2px;
  }
  div.placeholder * {
	visibility: hidden;
  }
  </style>
  
  <template>
	<div class="card" onClick="//this.parentNode.flip();">
		<div class="back"><content></content></div>
		<div class="front">
			<div class="contentarea">
				<div class="number">{{number}}</div>
				
				<div id="fireworkimages">
					<img class="firework firework1" src="/images/fireworks.png"></img>
					<img class="firework firework2" src="/images/fireworks.png"></img>
					<img class="firework firework3" src="/images/fireworks.png"></img>
					<img class="firework firework4" src="/images/fireworks.png"></img>
					<img class="firework firework5" src="/images/fireworks.png"></img>
				</div>
			</div>
		</div>
		<div id="known" hidden="{{hideKnownIndicator(knownColor,knownNumber)}}">{{knownNumberDisplay(knownNumber)}}</div>
				
	</div>
	</div>
  </template>

  <script>
    FireworksCard = Polymer({
      is: "fireworks-card",

      properties: {
        index: {
			type: Number
		},
		color: {
			type: String,
			observer: "_colorChanged"
		},
        number: {
			type: Number,
			observer: "_numberChanged"
		},
		knownColor: {
			type: String,
			observer: "_knownColorChanged",
			value: "none"
		},
		knownNumber: {
			type: Number,
			value: -1
		},
		faceup: {
			type: Boolean,
			value: false,
			observer: "_faceupChanged"
		},
		placeholder: {
			type: Boolean,
			value: false,
			observer: "_placeholderChanged"
		}
      },
	  
	  factoryImpl: function(color, number, index) {
		this.color = color;
		this.number = number;
		this.index = index;
	  },
	  
	  getIndex: function() {
		return this.index;
	  },

      flip: function() {
      	this.faceup = !this.faceup;
      },
	  setFaceup(faceup) {
		this.faceup = faceup;
	  },
	  reveal: function () {
		this.placeholder = false;
	  },
	  getColor: function() {
		return this.color;
	  },
	  setColor: function(color) {
		this.color = color;
	  },
	  getNumber: function() {
		return this.number;
	  },
	  setNumber: function(number) {
		this.number = number;
	  },
	  setKnownNumber: function(number) {
		this.knownNumber = number;
	  },
	  setKnownColor: function(color) {
		this.knownColor = color;
	  },
	  getKnownNumber: function() {
		return this.knownNumber;
	  },
	  getKnownColor: function() {
		return this.knownColor;
	  },
      _faceupChanged: function(newFU, oldFU) {
		this.children[0].classList.toggle("faceup",newFU);
      },

      _placeholderChanged: function(newPH, oldPH) {
		this.children[0].classList.toggle("placeholder",newPH);
      },
	  
	  _colorChanged: function (newColor, oldColor) {
		this.children[0].classList.remove("color-" + oldColor);
		this.children[0].classList.add("color-" + newColor);
	  },
	  
	  _numberChanged: function (newNumber, oldNumber) {
		this.children[0].classList.remove("number-" + oldNumber);
		this.children[0].classList.add("number-" + newNumber);
	  },
	  
	  ready: function() {
		images = this.$.fireworkimages.children;
		for(i=0; i<images.length; i++) {
			images[i].style.transform = "rotateZ("+Math.random() * 360+"deg)";
		}
		if(this.faceup) { this.children[0].classList.add("faceup"); }
		if(this.placeholder) { this.children[0].classList.add("placeholder"); }
	   },
		
		hideKnownIndicator: function(color,number) {
			return ((color == "" || color == "none") && number < 1)
		},
		_knownColorChanged: function(newColor, oldColor) {
			this.$.known.classList.remove("knowncolor-" + oldColor);
			this.$.known.classList.add("knowncolor-" + newColor);
		},
		knownNumberDisplay: function(number) {
			if (number < 1) return "?";
			else return number;
		}

    });
  </script>

</dom-module>
