
<dom-module id="fireworks-card">

  <style>
  :host {
  perspective: 1000px;
  display: inline-block;
  }


  
  .card, .back, .front {
	width: 47px;
	height: 60px;
	border-radius: 2px;
	cursor: pointer;
	user-select: none;
  }
  
  .back, .front {
	backface-visibility: hidden;
	position: absolute;
	top: 0;
	left: 0;
	text-shadow: 1px 1px #444;
  }
  
  div.card {
	border: 1px solid #AAA;
	position: relative;
/*	transform-style: preserve-3d;
	transition: 0.4s;
	transform: rotateY(180deg);*/
  }
  
  div.card.highlight {
    border: 1px solid #0F0;
  }
  
/*  div.faceup {
  	transform: none;
	transform-style: preserve-3d;
	transition: 0.4s;
  }
*/
  
  div.back {
	background-color: #AAA;
	background-size: 47px 78px;
/*	transform: rotateY(180deg); */
	border: 2px solid white;
	box-sizing: border-box;
	color: white;
	font-size: 25pt;
	text-align: center;
	z-index: 5;
    padding-top: 5px;
  }
  
  
  div.showbackground {
	background-image: url("../images/hanabi.jpg");
  }
  
 .faceup div.back {
	display: none;
 }
  
  div.contentarea {
	border: 2px solid #006;
	width: 100%;
	height: 100%;
	border-radius: 2px;
	box-sizing: border-box;
	background-color: #005C99;
  }
  
  div.front {
	z-index: 4;
  }
  
/* 
  div.number:first-of-type {
	text-align: left;
	vertical-align: top;
	left: 4px;
	top: 1px;
  }
*/
  div.number {
	font-size: 3.8em;
	font-family: Arial;
//	text-align: right;
//	vertical-align: bottom;
	position: absolute;
	left: 6px; //130px;
	top: -5px; //225px;
	font-weight: bold;
  }

  
  .color-blue, #known.knowncolor-blue, .rainbow4, .rainbow9, .knownrainbow4 {
	color: #09F;
  }
  .color-red, #known.knowncolor-red, .rainbow1, .rainbow6, .knownrainbow1 {
	color: #F33;
  }
  .color-green, #known.knowncolor-green, .rainbow3, .rainbow8, .knownrainbow3 {
	color: #090;
  }
  .color-yellow, #known.knowncolor-yellow, .rainbow2, .rainbow7, .knownrainbow2 {
	color: #FD4;
  }
  .color-white, #known.knowncolor-white, .rainbow5, .rainbow10, .knownrainbow5 {
	color: white;
  }

  .rainbowcontainer, .knownrainbowcontainer {
  	display: none;
  	position: relative;
  }
  .color-rainbow .rainbowcontainer, .knowncolor-rainbow .knownrainbowcontainer {
  	display: block;
  }
  .color-rainbow .nonrainbow, .knowncolor-rainbow .knownnonrainbow {
  	display: none;
  }

  .contentarea .rainbowcontainer div {
  	height: 5px;
  	overflow: hidden;
  }

  .knownrainbowcontainer div {
  	height: 2px;
  	overflow: hidden;
  }

  .rainbowcontainer div span {
  	position: relative;
  }

  .knownrainbowcontainer div span {
  	position: relative;
  }

  .rainbow1 {
  	margin-top: 10px;
  }
  .rainbow1 span {
  	top: -10px;
  }
  .rainbow2 span {
  	top: -15px;
  }
  .rainbow3 span {
  	top: -20px;
  }
  .rainbow4 span {
  	top: -25px;
  }
  .rainbow5 span {
  	top: -30px;
  }
  .rainbow6 span {
  	top: -35px;
  }
  .rainbow7 span {
  	top: -40px;
  }
  .rainbow8 span {
  	top: -45px;
  }
  .rainbow9 span {
  	top: -50px;
  }
  .rainbow10 span {
  	top: -55px;
  }

  .knownrainbow1 span {

  }
  .knownrainbow2 span {
  	top: -2px;
  }
  .knownrainbow3 span {
  	top: -4px;
  }
  .knownrainbow4 span {
  	top: -6px;
  }
  .knownrainbow5 span {
  	top: -8px;
  }

  #known {
  	color: #999;
  	position: absolute;
	top: 45px;
  	left: 2px;
  	border: 1px solid white;
  	background-color: black;
  	font-family: arial;
  	font-size: 0.7em;
  	width: 12px;
  	height: 12px;
  	z-index: 6;
  	text-align: center;
  	font-weight: bold;
  }

  div.placeholder {
	border: 1px dotted #999;
	border-radius: 2px;
  }
  div.placeholder * {
	visibility: hidden;
  }
  </style>
  
  <template>
	<div class="card" onClick="//this.parentNode.flip();">
		<div class="back showbackground" id="back"><content></content></div>
		<div class="front">
			<div class="contentarea">
				<div class="number nonrainbow">[[number]]</div>
				<div class="number rainbowcontainer">
					<div class="rainbow1"><span>[[number]]</span></div>
					<div class="rainbow2"><span>[[number]]</span></div>
					<div class="rainbow3"><span>[[number]]</span></div>
					<div class="rainbow4"><span>[[number]]</span></div>
					<div class="rainbow5"><span>[[number]]</span></div>
					<div class="rainbow6"><span>[[number]]</span></div>
					<div class="rainbow7"><span>[[number]]</span></div>
					<div class="rainbow8"><span>[[number]]</span></div>
					<div class="rainbow9"><span>[[number]]</span></div>
					<div class="rainbow10"><span>[[number]]</span></div>
				</div>
			</div>
		</div>
		<div id="known" hidden="{{hideKnownIndicator(knownColor,knownNumber)}}">
			<div class="knownnonrainbow">[[knownNumberDisplay(knownNumber)]]</div>
			<div class="knownrainbowcontainer">
				<div class="knownrainbow1"><span>[[knownNumberDisplay(knownNumber)]]</span></div>
				<div class="knownrainbow2"><span>[[knownNumberDisplay(knownNumber)]]</span></div>
				<div class="knownrainbow3"><span>[[knownNumberDisplay(knownNumber)]]</span></div>
				<div class="knownrainbow4"><span>[[knownNumberDisplay(knownNumber)]]</span></div>
				<div class="knownrainbow5"><span>[[knownNumberDisplay(knownNumber)]]</span></div>
			</div>
		</div>

	</div>
	</div>
  </template>

  <script>
    FireworksCard = Polymer({
      is: "fireworks-card",

      properties: {
        id: {
            type: Number
        },
        index: {
			type: Number
		},
		color: {
			type: String,
			observer: "_colorChanged"
		},
        number: {
			type: Number,
			observer: "_numberChanged"
		},
		knownColor: {
			type: String,
			observer: "_knownColorChanged",
			value: "none"
		},
		knownNumber: {
			type: Number,
			value: -1
		},
		faceup: {
			type: Boolean,
			value: false,
			observer: "_faceupChanged"
		},
		placeholder: {
			type: Boolean,
			value: false,
			observer: "_placeholderChanged"
		},
        showBackground: {
            type: Boolean,
            value: true,
            observer: "_showBackgroundChanged"
        }
      },
	  
	  factoryImpl: function(id, color, number, index) {
        this.id = id;
		this.color = color;
		this.number = number;
		this.index = index;
	  },
      
      _showBackgroundChanged: function(newvalue, oldvalue) {
        if(newvalue == true) {
            this.$.back.classList.add("showbackground");
        }
        else {
            this.$.back.classList.remove("showbackground");
        }
      },
	  
	  getIndex: function() {
		return this.index;
	  },

      flip: function() {
      	this.faceup = !this.faceup;
      },
	  setFaceup(faceup) {
		this.faceup = faceup;
	  },
	  reveal: function () {
		this.placeholder = false;
	  },
	  getColor: function() {
		return this.color;
	  },
	  setColor: function(color) {
		this.color = color;
	  },
	  getNumber: function() {
		return this.number;
	  },
	  setNumber: function(number) {
		this.number = number;
	  },
	  setKnownNumber: function(number) {
		this.knownNumber = number;
	  },
	  setKnownColor: function(color) {
		this.knownColor = color;
	  },
	  getKnownNumber: function() {
		return this.knownNumber;
	  },
	  getKnownColor: function() {
		return this.knownColor;
	  },
      _faceupChanged: function(newFU, oldFU) {
		this.children[0].classList.toggle("faceup",newFU);
      },

      _placeholderChanged: function(newPH, oldPH) {
		this.children[0].classList.toggle("placeholder",newPH);
      },
	  
	  _colorChanged: function (newColor, oldColor) {
		this.children[0].classList.remove("color-" + oldColor);
		this.children[0].classList.add("color-" + newColor);
	  },
	  
	  _numberChanged: function (newNumber, oldNumber) {
		this.children[0].classList.remove("number-" + oldNumber);
		this.children[0].classList.add("number-" + newNumber);
	  },
	  
	  ready: function() {
		/*images = this.$.fireworkimages.children;
		for(i=0; i<images.length; i++) {
			images[i].style.transform = "rotateZ("+Math.random() * 360+"deg)";
		}*/
		if(this.faceup) { this.children[0].classList.add("faceup"); }
		if(this.placeholder) { this.children[0].classList.add("placeholder"); }
	   },
		
		hideKnownIndicator: function(color,number) {
			return ((color == "" || color == "none") && number < 1)
		},
		_knownColorChanged: function(newColor, oldColor) {
			this.$.known.classList.remove("knowncolor-" + oldColor);
			this.$.known.classList.add("knowncolor-" + newColor);
		},
		knownNumberDisplay: function(number) {
			if (number < 1) return "?";
			else return number;
		},
        setHighlighted: function (highlight) {
            if(highlight == true) {
                this.children[0].classList.add("highlight");
            }
            else {
                this.children[0].classList.remove("highlight");
            }
        }
        

    });
  </script>

</dom-module>
