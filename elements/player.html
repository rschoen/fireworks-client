
<dom-module id="fireworks-player">

<style>
#player {
	width: 160px;
	height: 72px;
	border-radius: 3px;
	border: 1px solid #AAA;
	background: white;
	will-change: transform;
	transform-origin: 0 0;
	
	transition: 0.4s;
	z-index: 2;
}



#name {
	position: relative;
	left: 10px;
	top: -13px;
	z-index: 3;
	background: white;
	padding: 1px 5px 0;
	border-radius: 3px;
	font-size: 0.8em;
}

#name.current {
	background: yellow;
}

.selected {
	left: 100px;
	top: 100px;
	transform: scale(2.0);
	
	transition: 0.4s;
}
.on-top {
	z-index: 5;
}
  .small-card {
//  	transform: scale(0.25);
//  	transform-origin: 0 0;
  }
  fireworks-card { position: absolute; top: 5px; }
  .card1 { margin-left: 66%; z-index: 5; }
  .card2 { margin-left: 50.25%; z-index: 4; }
  .card3 { margin-left: 34.5%; z-index: 3; }
  .card4 { margin-left: 18.75%; z-index: 2; }
  .card5 { margin-left: 3%; z-index: 1; }
  
  .local .card1 { margin-left: 3%; z-index: 1; }
  .local .card2 { margin-left: 18.75%; z-index: 2; }
  .local .card3 { margin-left: 34.5%; z-index: 3; }
  .local .card4 { margin-left: 50.25%; z-index: 4; }
  .local .card5 { margin-left: 66%; z-index: 5; }
  
  /* TODO: still needed
  - check z-index with dialogs and make consistent.
  - check that it still looks right for the other person, truly.
  - try on mobile just to be sure
  </style>
  
  <template>
	<div id="player">
	<span id="name">[[_displayName(name,lastMove)]]</span>
	<div id="cards"></div>
	</div>
  </template>

  <script>
    FireworksPlayer = Polymer({
      is: "fireworks-player",

      properties: {
        id: {
            type: String
        },
      	name: {
      		type: String
      	},
      	number: {
      		type: Number
      	},
	      numCards: {
	          type: Number,
	          value: 0
        },
        lastMove: {
            type: String
        },
        localPlayer: {
            type: Boolean,
            value: false,
            observer: "_localPlayerChanged"
        }
      },
      
	  factoryImpl: function(id, name, lastMove, number) {
        this.id = id;
		this.name = name;
        this.lastMove = lastMove;
		this.number = number;
	  },
	  
	  addCard: function(id, color, number, knowncolor, knownnumber, index) {
		var card = new FireworksCard(id, color, number, index);
		card.setKnownNumber(knownnumber);
		card.setKnownColor(knowncolor);
		if(this.number > 0 ) // not the local player
		{
			card.flip();
		}
		this.numCards++;
		card.classList.add("card" + this.numCards);
		Polymer.dom(this.root).appendChild(card)
		Polymer.dom(this.root).querySelector("#cards").appendChild(card)
        return card;
	  },
	  
	  getName: function() {
		return this.name;
	  },
      
      getID: function () {
        return this.id;
      },
    
    _localPlayerChanged: function(newvalue) {
      if(newvalue) {
        this.$.player.classList.add("local");
      }
      else {
        this.$.player.classList.remove("local");
      }
    },
	  
	  setCurrentPlayer: function() {
		this.$.name.classList.add("current");
	  },
      
      _displayName: function(name,lastMove) {
        var display = name
        if(lastMove != "") {
            display += " " + lastMove;
        }
        return display;
      }
      
    });
  </script>

</dom-module>
